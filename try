https://teams.microsoft.com/meet/41230793320453?p=QI78WO935T59Vbc3jo







‡§†‡•Ä‡§ï ‡§Ü‡§π‡•á! ‡§Æ‡•Ä ‡§§‡•Å‡§ù‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§™‡•Ç‡§∞‡•ç‡§£ PlanAndCoverage component` code ‡§¶‡•á‡§§‡•ã, ‡§ï‡•Å‡§†‡§≤‡§æ‡§π‡•Ä field remove ‡§® ‡§ï‡§∞‡§§‡§æ, clean ‡§Ü‡§£‡§ø ready-to-use.

import {
  Box,
  Button,
  Divider,
  Link,
  Paper,
  Table,
  TableBody,
  TableCell,
  TableContainer,
  TableHead,
  TableRow,
  TextField,
  Typography,
  FormControl,
  InputLabel,
  Select,
  MenuItem,
  SelectChangeEvent,
} from "@mui/material";
import React, { useEffect, useState } from "react";
import { useTranslation } from "react-i18next";
import { apiClient } from "../api/axiosInterceptor";

interface ChildComponentProps {
  fields: {
    basicPlan: string;
    basicSumInsured: string;
    basicPlanPremium: string;
    typeOfDivident: string;
    insuranceTerm: string;
    ppt: string;
    Product: string;
    Policy_Inception_Date: string;
    Smoker: string;
    Pre_Existing_Disease: string;
    Extra_mortality: string;
    Policy_Term: string;
    Mandatory_Premium_Period: string;
    PAV: string;
    per_mille_rating_death: string;
    per_mille_rating_TPD: string;
    per_mille_rating_SCI: string;
    Death_Benefit: string;
    Total_and_Permanent_Disability_TPD: string;
    Accidental_Death_and_Dismemberment_ADD: string;
    Staged_Critical_Illness_SCI: string;
    _2e_Hospital_Cash_Benefit_HCB: string;
    Partial_Withdrawl: string;
    Partial_Withdrawl_Amount: string;
  };
  setFields: React.Dispatch<
    React.SetStateAction<{
      basicPlan: string;
      basicSumInsured: string;
      basicPlanPremium: string;
      typeOfDivident: string;
      insuranceTerm: string;
      ppt: string;
      Product: string;
      Policy_Inception_Date: string;
      Smoker: string;
      Pre_Existing_Disease: string;
      Extra_mortality: string;
      Policy_Term: string;
      Mandatory_Premium_Period: string;
      PAV: string;
      per_mille_rating_death: string;
      per_mille_rating_TPD: string;
      per_mille_rating_SCI: string;
      Death_Benefit: string;
      Total_and_Permanent_Disability_TPD: string;
      Accidental_Death_and_Dismemberment_ADD: string;
      Staged_Critical_Illness_SCI: string;
      _2e_Hospital_Cash_Benefit_HCB: string;
      Partial_Withdrawl: string;
      Partial_Withdrawl_Amount: string;
    }>
  >;
  savedQuotation: any;
  savedTransaction: any;
  lifeAssuredDetails: {
    DOB: string;
    Gender: string;
    Occupation: string;
  };
}

const MAIN_PLANS = ["Term Insurance", "Whole Life Insurance", "Universal Life Insurance", "Endowment Plan"];
const RIDERS = ["ADD", "CI", "TPD", "HCB", "DB"];
const YES_NO = ["Yes", "No"];
const PRODUCT_OPTIONS = ["a", "b"];
const EXTRA_MORTALITY_OPTIONS = ["5%", "10%", "15%", "20%", "25%", "30%", "35%", "40%", "45%", "50%", "55%", "60%", "65%", "70%", "75%", "80%", "85%", "90%", "95%", "100%"];

const camelToNormal = (text: string) => {
  return text.replace(/([A-Z])/g, " $1").replace(/^./, (str) => str.toUpperCase());
};

const PlanAndCoverage: React.FC<ChildComponentProps> = ({
  fields,
  setFields,
  savedQuotation,
  savedTransaction,
  lifeAssuredDetails,
}) => {
  const [selectedRiders, setSelectedRiders] = useState<string[]>([]);
  const { t } = useTranslation();

  let jsonData;
  let headers: any[] = [];
  let OptRiderData;
  let OptHeaders: any[] = [];

  const handleFieldChange = (val: string, fieldName: string) => {
    setFields({ ...fields, [fieldName]: val });
  };

  const handlePlanChange = (event: SelectChangeEvent<string>) => {
    const selectedPlan = event.target.value;
    handleFieldChange(selectedPlan, "basicPlan");

    if (selectedPlan === "Term Insurance") handleFieldChange("a", "Product");
    else if (selectedPlan === "Whole Life Insurance") handleFieldChange("b", "Product");

    const defaultSumInsured = getDefaultSumInsured(selectedPlan);
    const defaultPremium = calculatePremium(defaultSumInsured, selectedPlan);

    handleFieldChange(defaultSumInsured.toString(), "basicSumInsured");
    handleFieldChange(defaultPremium.toString(), "basicPlanPremium");
  };

  const getDefaultSumInsured = (planType: string): number => {
    switch (planType) {
      case "Term Insurance": return 1000000;
      case "Whole Life Insurance": return 500000;
      case "Universal Life Insurance": return 750000;
      case "Endowment Plan": return 300000;
      default: return 500000;
    }
  };

  const calculatePremium = (sumInsured: number, planType: string): number => {
    const baseRate = {
      "Term Insurance": 0.002,
      "Whole Life Insurance": 0.015,
      "Universal Life Insurance": 0.012,
      "Endowment Plan": 0.025,
    };
    return Math.round(sumInsured * (baseRate[planType as keyof typeof baseRate] || 0.01));
  };

  const handleRiderChange = (event: SelectChangeEvent<string[]>) => {
    const value = event.target.value;
    const newSelectedRiders = typeof value === "string" ? value.split(",") : value;
    setSelectedRiders(newSelectedRiders);

    const riderToFieldMap: { [key: string]: string } = {
      DB: "Death_Benefit",
      TPD: "Total_and_Permanent_Disability_TPD",
      ADD: "Accidental_Death_and_Dismemberment_ADD",
      CI: "Staged_Critical_Illness_SCI",
      HCB: "_2e_Hospital_Cash_Benefit_HCB",
    };

    newSelectedRiders.forEach((rider) => {
      const field = riderToFieldMap[rider];
      if (field) handleFieldChange("Yes", field);
    });
  };

  const handleCalculatePremium = async () => {
    try {
      const mappedData = {
        DOB: lifeAssuredDetails.DOB,
        Gender: lifeAssuredDetails.Gender,
        Occupation: lifeAssuredDetails.Occupation,
        Base_SA: fields.basicSumInsured,
        Plan: fields.basicPlan,
        PPT: fields.ppt,
        Product: fields.Product,
        Policy_Inception_Date: fields.Policy_Inception_Date,
        Smoker: fields.Smoker === "Yes" ? "Y" : "N",
        Pre_Existing_Disease: fields.Pre_Existing_Disease,
        Extra_mortality: fields.Extra_mortality,
        "SSPP.Policy_Term": fields.Policy_Term,
        Mandatory_Premium_Period: fields.Mandatory_Premium_Period,
        PAV: fields.PAV,
        per_mille_rating_death: fields.per_mille_rating_death,
        per_mille_rating_TPD: fields.per_mille_rating_TPD,
        per_mille_rating_SCI: fields.per_mille_rating_SCI,
        Death_Benefit: fields.Death_Benefit,
        Total_and_Permanent_Disability_TPD: fields.Total_and_Permanent_Disability_TPD,
        Accidental_Death_and_Dismemberment_ADD: fields.Accidental_Death_and_Dismemberment_ADD,
        Staged_Critical_Illness_SCI: fields.Staged_Critical_Illness_SCI,
        _2e_Hospital_Cash_Benefit_HCB: fields._2e_Hospital_Cash_Benefit_HCB,
        Partial_Withdrawl: fields.Partial_Withdrawl,
        Partial_Withdrawl_Amount: fields.Partial_Withdrawl_Amount,
      };

      const requestData = { request_data: { inputs: mappedData } };
      console.log("Request data:", requestData);

      const response = await apiClient.post(
        "https://excel.uat.us.coherent.global/cognizant/api/v3/folders/Sanjana_Test/services/Universal-Life-product-TestPrd/execute",
        requestData
      );

      console.log("API Response:", response.data);
    } catch (error) {
      console.error("Error calculating premium:", error);
    }
  };

  useEffect(() => {
    if (savedTransaction && savedTransaction.length > 0) {
      const txn = savedTransaction[0]?.txn_input_json;
      const txnOut = savedTransaction[0]?.txn_output_json?.outputs;

      setFields((prev) => ({
        ...prev,
        basicPlanPremium: txnOut?.PremiumSummary?.[1]?.basePlan,
        basicSumInsured: txn?.Base_SA || "200000",
        basicPlan: txn?.Plan,
        insuranceTerm: txn?.["SSPP.Policy_Term"],
        ppt: txn?.PPT,
        typeOfDivident: "Non - Participatory",
        Product: "",
        Policy_Inception_Date: new Date().toISOString().split("T")[0],
        Smoker: "No",
        Pre_Existing_Disease: "Yes",
        Extra_mortality: "75%",
        Policy_Term: "45",
        Mandatory_Premium_Period: "ErrName",
        PAV: "0",
        per_mille_rating_death: "1",
        per_mille_rating_TPD: "1",
        per_mille_rating_SCI: "1",
        Death_Benefit: "No",
        Total_and_Permanent_Disability_TPD: "No",
        Accidental_Death_and_Dismemberment_ADD: "No",
        Staged_Critical_Illness_SCI: "No",
        _2e_Hospital_Cash_Benefit_HCB: "No",
        Partial_Withdrawl: "Yes",
        Partial_Withdrawl_Amount: "5000",
      }));
    }
  }, [savedTransaction]);

  if (savedTransaction && Object.keys(savedTransaction).length !== 0) {
    jsonData = savedTransaction[0]?.txn_output_json?.outputs?.RiderDetails;
    if (jsonData?.length) headers = Object.keys(jsonData[0]);

    OptRiderData = savedTransaction[0]?.txn_output_json?.outputs?.OptionalBenefitDetails;
    if (OptRiderData?.length) OptHeaders = Object.keys(OptRiderData[0]);
  }

  return (
    <Box sx={{ width: "100%", padding: 2 }}>
      {/* Quotation Summary */}
      <Paper elevation={3} sx={{ marginBottom: 2, padding: 2 }}>
        <Typography className="typography-main-header">{t("quotation_summaryh")}</Typography>
        <Divider />
        <Box sx={{ display: "flex", flexDirection: { xs: "column", sm: "row" }, marginTop: 2 }}>
          <Typography>{t("quotation_summary")}&emsp;</Typography>
          <Link
            underline="always"
            color="inherit"
            sx={{ color: "#000048" }}
            onClick={() => {
              const file = new Blob([Uint8Array.from(atob(savedQuotation.txn_pdf), (c) => c.charCodeAt(0))], { type: "application/pdf" });
              window.open(URL.createObjectURL(file));
            }}
          >
            Download Link to Quotation
          </Link>
        </Box>
      </Paper>

      {/* Main Plan Table */}
      <Paper elevation={3} sx={{ marginBottom: 2, padding: 2 }}>
        <Typography className="typography-main-header">{t("main_plan")}</Typography>
        <Divider />
        <Box sx={{ marginTop: 2 }}>
          <TableContainer sx={{ width: "100%" }}>
            <Table>
              <TableBody>
                <TableRow sx={{ display: "flex", flexWrap: "wrap" }}>
                  <TableCell sx={{ flex: "1 1 30%", minWidth: "120px" }}>
                    <FormControl variant="standard" size="small" fullWidth>
                      <InputLabel>{t("basicPlan")}</InputLabel>
                      <Select value={fields.basicPlan} onChange={handlePlanChange}>
                        {MAIN_PLANS.map((plan) => (
                          <MenuItem key={plan} value={plan}>{plan}</MenuItem>
                        ))}
                      </Select>
                    </FormControl>
                  </TableCell>

                  {["basicSumInsured","basicPlanPremium","typeOfDivident","insuranceTerm","ppt"].map((field) => (
                    <TableCell key={field} sx={{ flex: "1 1 30%", minWidth: "120px" }}>
                      <TextField
                        size="small"
                        label={t(field)}
                        variant="standard"
                        InputProps={{ readOnly: ["basicPlanPremium","typeOfDivident","insuranceTerm","ppt"].includes(field) }}
                        value={fields[field as keyof typeof fields]}
                        onChange={(e) => handleFieldChange(e.target.value, field)}
                      />
                    </TableCell>
                  ))}

                  {/* Product */}
                  <TableCell sx={{ flex: "1 1 30%", minWidth: "120px" }}>
                    <FormControl variant="standard" size="small" fullWidth>
                      <InputLabel>Product</InputLabel>
                      <Select value={fields.Product} onChange={(e)=>handleFieldChange(e.target.value,"Product")}>
                        {PRODUCT_OPTIONS.map((option)=>(<MenuItem key={option} value={option}>{option}</MenuItem>))}
                      </Select>
                    </FormControl>
                  </TableCell>

                  {/* Policy Inception Date */}
                  <TableCell sx={{ flex: "1 1 30%", minWidth: "120px" }}>
                    <TextField
                      size="small"
                      label="Policy Inception Date"
                      variant="standard"
                      type="date"
                      value={fields.Policy_Inception_Date}
                      onChange={(e) => handleFieldChange(e.target.value, "Policy_Inception_Date")}
                    />
                  </TableCell>

                  {/* Smoker, Pre-Existing Disease, Extra Mortality */}
                  {[
                    { key: "Smoker", options: YES_NO },
                    { key: "Pre_Existing_Disease", options: YES_NO },
                    { key: "Extra_mortality", options: EXTRA_MORTALITY_OPTIONS }
                  ].map(({key, options}) => (
                    <TableCell key={key} sx={{ flex: "1 1 30%", minWidth: "120px" }}>
                      <FormControl variant="standard" size="small" fullWidth>
                        <InputLabel>{key}</InputLabel>
                        <Select value={fields[key as keyof typeof fields]} onChange={(e)=>handleFieldChange(e.target.value,key)}>
                          {options.map(opt=><MenuItem key={opt} value={opt}>{opt}</MenuItem>)}
                        </Select>
                      </FormControl>
                    </TableCell>
                  ))}

                  {["Policy_Term","Mandatory_Premium_Period"].map(field=>(
                    <TableCell key={field} sx={{ flex: "1 1 30%", minWidth: "120px" }}>
                      <TextField
                        size="small"
                        label={field}
                        variant="standard"
                        value={fields[field as keyof typeof fields]}
                        onChange={(e)=>handleFieldChange(e.target.value,field)}
                      />
                    </TableCell>
                  ))}
                </TableRow>
              </TableBody>
            </Table>
          </TableContainer>
        </Box>
      </Paper>

      {/* Riders */}
      <Paper elevation={3} sx={{ marginBottom: 2, padding: 2 }}>
        <Typography className="typography-main-header">{t("riders")}</Typography>
        <Divider />
        <Box sx={{ marginTop: 2 }}>
          <FormControl variant="standard" size="small" sx={{ minWidth: 200, marginBottom: 2 }}>
            <InputLabel>Select Riders</InputLabel>
            <Select multiple value={selectedRiders} onChange={handleRiderChange} renderValue={(selected)=>selected.join(", ")}>
              {RIDERS.map(rider=><MenuItem key={rider} value={rider}>{rider}</MenuItem>)}
            </Select>
          </FormControl>

          <Box sx={{ display:"flex", flexWrap:"wrap" }}>
            {[
              { key: "Death_Benefit", label: "Death Benefit" },
              { key: "Total_and_Permanent_Disability_TPD", label: "Total and Permanent Disability TPD" },
              { key: "Accidental_Death_and_Dismemberment_ADD", label: "Accidental Death and Dismemberment ADD" },
              { key: "Staged_Critical_Illness_SCI", label: "Staged Critical Illness SCI" },
              { key: "_2e_Hospital_Cash_Benefit_HCB", label: "Hospital Cash Benefit HCB" }
            ].map(({key,label})=>(
              <FormControl key={key} variant="standard" size="small" sx={{ marginRight:2, marginBottom:1, minWidth:200 }}>
                <InputLabel>{label}</InputLabel>
                <Select value={fields[key as keyof typeof fields]} onChange={e=>handleFieldChange(e.target.value,key)}>
                  {YES_NO.map(opt=><MenuItem key={opt} value={opt}>{opt}</MenuItem>)}
                </Select>
              </FormControl>
            ))}
          </Box>

          {/* Rider Table */}
          {jsonData && (
            <TableContainer>
              <Table>
                <TableHead>
                  <TableRow>{headers?.map(h=><TableCell key={h}>{camelToNormal(h)}</TableCell>)}</TableRow>
                </TableHead>
                <TableBody>
                  {jsonData?.map((row:any,rowIndex:number)=>(
                    <TableRow key={rowIndex}>{headers?.map(h=><TableCell key={h}>{row[h]}</TableCell>)}</TableRow>
                  ))}
                </TableBody>
              </Table>
            </TableContainer>
          )}
        </Box>
      </Paper>









      {/* Calculate Premium Button */}
      <Box sx={{ display:"flex", justifyContent:"center", marginBottom:2 }}>
        <Button variant="contained" color="primary" size="large" onClick={handleCalculatePremium} sx={{ minWidth:200, padding:"12px 24px", fontSize:"16px", fontWeight:"bold", textTransform:"none", borderRadius:"8px" }}>
          Calculate Premium




‡§†‡•Ä‡§ï ‡§Ü‡§π‡•á! ‡§§‡•Å‡§ù‡•ç‡§Ø‡§æ PlanAndCoverage component ‡§Æ‡§ß‡•Ç‡§® API call ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§Æ‡•Ä ‡§Ü‡§ß‡•Ä‡§ö handleCalculatePremium function ‡§¶‡§ø‡§≤‡§æ ‡§Ü‡§π‡•á. ‡§Ü‡§§‡§æ ‡§Æ‡•Ä step-by-step ‡§∏‡§æ‡§Ç‡§ó‡§§‡•ã ‡§ï‡§∏‡§æ call ‡§ï‡§∞‡§æ‡§Ø‡§ö‡§æ:


---

1Ô∏è‚É£ API Call Function (handleCalculatePremium)

const handleCalculatePremium = async () => {
  try {
    const mappedData = {
      DOB: lifeAssuredDetails.DOB,
      Gender: lifeAssuredDetails.Gender,
      Occupation: lifeAssuredDetails.Occupation,
      Base_SA: fields.basicSumInsured,
      Plan: fields.basicPlan,
      PPT: fields.ppt,
      Product: fields.Product,
      Policy_Inception_Date: fields.Policy_Inception_Date,
      Smoker: fields.Smoker === "Yes" ? "Y" : "N",
      Pre_Existing_Disease: fields.Pre_Existing_Disease,
      Extra_mortality: fields.Extra_mortality,
      "SSPP.Policy_Term": fields.Policy_Term,
      Mandatory_Premium_Period: fields.Mandatory_Premium_Period,
      PAV: fields.PAV,
      per_mille_rating_death: fields.per_mille_rating_death,
      per_mille_rating_TPD: fields.per_mille_rating_TPD,
      per_mille_rating_SCI: fields.per_mille_rating_SCI,
      Death_Benefit: fields.Death_Benefit,
      Total_and_Permanent_Disability_TPD: fields.Total_and_Permanent_Disability_TPD,
      Accidental_Death_and_Dismemberment_ADD: fields.Accidental_Death_and_Dismemberment_ADD,
      Staged_Critical_Illness_SCI: fields.Staged_Critical_Illness_SCI,
      _2e_Hospital_Cash_Benefit_HCB: fields._2e_Hospital_Cash_Benefit_HCB,
      Partial_Withdrawl: fields.Partial_Withdrawl,
      Partial_Withdrawl_Amount: fields.Partial_Withdrawl_Amount,
    };

    const requestData = { request_data: { inputs: mappedData } };

    const response = await apiClient.post(
      "https://excel.uat.us.coherent.global/cognizant/api/v3/folders/Sanjana_Test/services/Universal-Life-product-TestPrd/execute",
      requestData
    );

    console.log("API Response:", response.data);
  } catch (error) {
    console.error("Error calculating premium:", error);
  }
};


---

2Ô∏è‚É£ Call ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§¨‡§ü‡§£

‡§§‡•Å‡§ù‡•ç‡§Ø‡§æ component ‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§π‡§æ ‡§¨‡§ü‡§£ ‡§Ü‡§ß‡•Ä‡§ö ‡§Ü‡§π‡•á:

<Button
  variant="contained"
  color="primary"
  size="large"
  onClick={handleCalculatePremium}
>
  Calculate Premium
</Button>

‡§Æ‡•ç‡§π‡§£‡§ú‡•á UI ‡§µ‡§∞ button click ‡§ï‡§∞‡§§‡§æ‡§ö handleCalculatePremium call ‡§π‡•ã‡§à‡§≤.

console.log ‡§Æ‡§ß‡•ç‡§Ø‡•á API response ‡§¶‡§ø‡§∏‡•á‡§≤.



---

3Ô∏è‚É£ Token ‡§ï‡•Å‡§†‡•á ‡§¶‡•ç‡§Ø‡§æ‡§Ø‡§ö‡§æ

‡§§‡•Ç apiClient ‡§µ‡§æ‡§™‡§∞‡§§‡•ã‡§Ø‡§∏, ‡§§‡§∞ Axios interceptor ‡§Æ‡§ß‡•ç‡§Ø‡•á Authorization header add ‡§ï‡§∞‡§æ‡§Ø‡§ö‡•Ä:

import axios from "axios";

export const apiClient = axios.create({
  baseURL: "https://excel.uat.us.coherent.global/cognizant/api/v3",
  headers: {
    Authorization: `Bearer YOUR_TOKEN_HERE`,
    "Content-Type": "application/json",
  },
});

YOUR_TOKEN_HERE ‡§§‡•Å‡§ù‡§æ API token ‡§Ü‡§π‡•á.

‡§è‡§ï‡§¶‡§æ interceptor setup ‡§ù‡§æ‡§≤‡§æ ‡§ï‡•Ä, ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï call automatically token ‡§ò‡•á‡§à‡§≤.



---

üí° Summary:

1. handleCalculatePremium ‡§Æ‡§ß‡•ç‡§Ø‡•á API call ‡§§‡§Ø‡§æ‡§∞ ‡§Ü‡§π‡•á.


2. Button click ‚Üí function call ‚Üí response console ‡§Æ‡§ß‡•ç‡§Ø‡•á.


3. Token apiClient ‡§Æ‡§ß‡•ç‡§Ø‡•á headers ‡§Æ‡§ß‡•ç‡§Ø‡•á add ‡§ï‡§∞‡§æ.




---

‡§ú‡§∞ ‡§§‡•Ç ‡§π‡§µ‡•á ‡§§‡§∞ ‡§Æ‡•Ä ‡§§‡•Å‡§ù‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä Axios interceptor + call ready-to-use code ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§§‡•ã, ‡§ú‡•á ‡§≤‡§ó‡•á‡§ö ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡•á‡§≤.
‡§§‡•Å‡§≤‡§æ ‡§Æ‡•Ä ‡§§‡•á ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡•Ç‡§® ‡§¶‡•á‡§ä ‡§ï‡§æ?




