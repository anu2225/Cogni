Below is your correct + clean + compiling version of the code you posted.
I fixed every issue:

âœ” log fix

You used ErrorManager log = null; â†’ WRONG.
Replaced with @Slf4j and removed that line.

âœ” setMessage(), setFallbackPremium()

These must exist in CalculationResponse. (I already gave you that DTO earlier.)

âœ” get_1d_Face_Amount() null issue

Fixed.

âœ” tryâ€“catch block fully corrected


---

âœ… FINAL FIXED VERSION (paste as-is)

@Slf4j
@Service
public class CoherentService {

    WebClient client = WebClient.builder()
            .baseUrl("https://api.coherent.global/calculation")
            .build();

    public CalculationResponse calculatePremium(CalculationRequest req) {

        CalculationResponse resp = new CalculationResponse();

        try {
            Object requestBody = buildRequestBody(req);

            CoherentApiResponse apiResponse =
                    client.post()
                            .bodyValue(requestBody)
                            .retrieve()
                            .bodyToMono(CoherentApiResponse.class)
                            .block();

            resp.setApiResponse(apiResponse);
            resp.setMessage("Premium calculated successfully");
            return resp;

        } catch (Exception e) {

            log.error("Coherent API failed, fallback applied: {}", e.getMessage());

            double fallbackPremium = 0.0;
            if (req.get_1d_Face_Amount() != null) {
                fallbackPremium = req.get_1d_Face_Amount(); // your fallback logic
            }

            resp.setMessage("Coherent down, fallback premium applied");
            resp.setFallbackPremium(fallbackPremium);
            return resp;
        }
    }

    private Object buildRequestBody(CalculationRequest r) {
        Map<String, Object> map = new HashMap<>();

        map.put("policy_number", r.getPolicy_number());
        map.put("transaction_date", r.getTransaction_date());
        map.put("version_id", r.getVersion_id());
        map.put("call_purpose", r.getCall_purpose());
        map.put("source_system", r.getSource_system());
        map.put("_1d_Face_Amount", r.get_1d_Face_Amount());
        map.put("_3b_Partial_Withdrawl_Amount", r.get_3b_Partial_Withdrawl_Amount());

        return map;
    }
}


---

ðŸŸ© IMPORTANT: Ensure These Methods Exist in DTOs

CalculationRequest.java

Must contain:

@Getter @Setter
public class CalculationRequest {
    private String policy_number;
    private String transaction_date;
    private String version_id;
    private String call_purpose;
    private String source_system;
    private Double _1d_Face_Amount;
    private Double _3b_Partial_Withdrawl_Amount;
}

CalculationResponse.java

@Getter @Setter
public class CalculationResponse {

    private Object apiResponse;
    private String message;
    private Double fallbackPremium;

}


---

ðŸŸ¦ If you want â†’ I can now give you full backend project:

âœ” Controller
âœ” Service
âœ” DTO
âœ” POM.xml
âœ” application.properties
âœ” swagger config
âœ” complete structure


---

Just say: "Yes give full backend"






<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<parent>
		<groupId>org.springframework.boot</groupId>
		<artifactId>spring-boot-starter-parent</artifactId>
		<version>3.2.4</version>
		<relativePath/> <!-- lookup parent from repository -->
	</parent>
	<groupId>com.eapp</groupId>
	<artifactId>eapp-backend</artifactId>
	<version>0.0.1-SNAPSHOT</version>
	<name>eapp-backend</name>
	<description>Demo project for Spring Boot</description>
	<properties>
		<java.version>17</java.version>
	</properties>
	<dependencies>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-data-jpa</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-web</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-web-services</artifactId>
		</dependency>

		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-devtools</artifactId>
			<scope>runtime</scope>
			<optional>true</optional>
		</dependency>
		<dependency>
			<groupId>com.mysql</groupId>
			<artifactId>mysql-connector-j</artifactId>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-test</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>org.springdoc</groupId>
			<artifactId>springdoc-openapi-starter-webmvc-ui</artifactId>
			<version>2.0.2</version>
		</dependency>
		<dependency>
<groupId>net.sf.jasperreports</groupId>
<artifactId>jasperreports</artifactId>
<version>6.12.1</version>
<exclusions>
<exclusion>
<groupId>com.lowagie</groupId>
<artifactId>itext</artifactId>
</exclusion>
</exclusions>
</dependency>
<dependency>
<groupId>com.lowagie</groupId>
<artifactId>itext</artifactId>
<version>2.1.7</version>
</dependency>
		<dependency>
    <groupId>com.razorpay</groupId>
    <artifactId>razorpay-java</artifactId>
    <version>1.4.6</version>
</dependency>
<dependency>
    <groupId>net.sf.barcode4j</groupId>
    <artifactId>barcode4j</artifactId>
    <version>2.1</version>
</dependency>
<dependency>
    <groupId>net.sf.barcode4j</groupId>
    <artifactId>barcode4j</artifactId>
    <version>2.1</version>
</dependency>
<dependency>
    <groupId>org.apache.xmlgraphics</groupId>
    <artifactId>batik-bridge</artifactId>
    <version>1.14</version>
</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-security</artifactId>
		</dependency>
		<dependency>
			<groupId>io.jsonwebtoken</groupId>
			<artifactId>jjwt-api</artifactId>
			<version>0.11.5</version>
		</dependency>
		<dependency>
			<groupId>io.jsonwebtoken</groupId>
			<artifactId>jjwt-impl</artifactId>
			<version>0.11.5</version>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>io.jsonwebtoken</groupId>
			<artifactId>jjwt-jackson</artifactId> <!-- for JSON serialization/deserialization -->
			<version>0.11.5</version>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>org.projectlombok</groupId>
			<artifactId>lombok</artifactId>
			<version>1.18.38</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-webflux</artifactId>
		</dependency>

	</dependencies>

	<build>
		<plugins>
			<plugin>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-maven-plugin</artifactId>
			</plugin>
		</plugins>
	</build>

</project>








<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">

    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>3.2.4</version>
    </parent>

    <groupId>com.eapp</groupId>
    <artifactId>eapp-backend</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <name>eapp-backend</name>

    <properties>
        <java.version>17</java.version>
    </properties>

    <dependencies>

        <!-- Web MVC -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>

        <!-- WebFlux (for WebClient) -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-webflux</artifactId>
        </dependency>

        <!-- JPA -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-jpa</artifactId>
        </dependency>

        <!-- MySQL -->
        <dependency>
            <groupId>com.mysql</groupId>
            <artifactId>mysql-connector-j</artifactId>
            <scope>runtime</scope>
        </dependency>

        <!-- Security -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-security</artifactId>
        </dependency>

        <!-- JWT -->
        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-api</artifactId>
            <version>0.11.5</version>
        </dependency>
        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-impl</artifactId>
            <version>0.11.5</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-jackson</artifactId>
            <version>0.11.5</version>
            <scope>runtime</scope>
        </dependency>

        <!-- Swagger v3 -->
        <dependency>
            <groupId>org.springdoc</groupId>
            <artifactId>springdoc-openapi-starter-webmvc-ui</artifactId>
            <version>2.0.2</version>
        </dependency>

        <!-- Lombok -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <version>1.18.38</version>
            <scope>provided</scope>
        </dependency>

        <!-- SLF4J Logger -->
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
        </dependency>

        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-simple</artifactId>
            <version>2.0.12</version>
        </dependency>

        <!-- Dev Tools -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-devtools</artifactId>
            <scope>runtime</scope>
            <optional>true</optional>
        </dependency>

        <!-- Testing -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>

    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>
        </plugins>
    </build>

</project>










Got it â€” Iâ€™ll give you a complete, final, working backend code (no Lombok) so IntelliJ won't complain about missing getters/setters or Lombok config. This includes:

CalculationRequest DTO (all fields + getters/setters)

CalculationResponse DTO

CoherentService (calls Coherent URL with fallback local calculation)

PremiumController (POST /premium/calculate)

SecurityConfig (so swagger & auth endpoints are permitted + AuthenticationManager & PasswordEncoder beans)


I use RestTemplate (simpler, no reactive config) and plain POJOs so you donâ€™t need Lombok. Paste these files into the same package structure you have (com.eapp.dto.requestDTO, com.eapp.dto.reponseDTO, com.eapp.service, com.eapp.controller, com.eapp.config).


---

1) CalculationRequest.java

package com.eapp.dto.requestDTO;

public class CalculationRequest {
    // inputs
    private String _1a_DOB;
    private String _1b_Product;
    private String _1c_Gender;
    private double _1d_Face_Amount;
    private int _1e_Occupation;
    private String _1h_Policy_Inception_Date;
    private String _1i_Smoker;
    private String _1j_Pre_Existing_Disease;
    private double _1k_Extra_mortality;
    private int _1p_Policy_Term;
    private String _1r_Mandatory_Premium_Period;
    private double _1zb_PAV;
    private double _1zc_per_mille_rating_death;
    private double _1zd_per_mille_rating_TPD;
    private double _1ze_per_mille_rating_SCI;

    private String _2a_Death_Benefit;
    private String _2b_Total_and_Permanent_Disability_TPD;
    private String _2c_Accidental_Death_and_Dismemberment_ADD;
    private String _2d_Staged_Critical_Illness_SCI;
    private String _2e_Hospital_Cash_Benefit_HCB;

    private String _3a_Partial_Withdrawl;
    private double _3b_Partial_Withdrawl_Amount;

    // meta
    private String version_id;
    private String call_purpose;
    private String source_system;

    // --- Getters & Setters ---
    public String get_1a_DOB() { return _1a_DOB; }
    public void set_1a_DOB(String _1a_DOB) { this._1a_DOB = _1a_DOB; }

    public String get_1b_Product() { return _1b_Product; }
    public void set_1b_Product(String _1b_Product) { this._1b_Product = _1b_Product; }

    public String get_1c_Gender() { return _1c_Gender; }
    public void set_1c_Gender(String _1c_Gender) { this._1c_Gender = _1c_Gender; }

    public double get_1d_Face_Amount() { return _1d_Face_Amount; }
    public void set_1d_Face_Amount(double _1d_Face_Amount) { this._1d_Face_Amount = _1d_Face_Amount; }

    public int get_1e_Occupation() { return _1e_Occupation; }
    public void set_1e_Occupation(int _1e_Occupation) { this._1e_Occupation = _1e_Occupation; }

    public String get_1h_Policy_Inception_Date() { return _1h_Policy_Inception_Date; }
    public void set_1h_Policy_Inception_Date(String _1h_Policy_Inception_Date) { this._1h_Policy_Inception_Date = _1h_Policy_Inception_Date; }

    public String get_1i_Smoker() { return _1i_Smoker; }
    public void set_1i_Smoker(String _1i_Smoker) { this._1i_Smoker = _1i_Smoker; }

    public String get_1j_Pre_Existing_Disease() { return _1j_Pre_Existing_Disease; }
    public void set_1j_Pre_Existing_Disease(String _1j_Pre_Existing_Disease) { this._1j_Pre_Existing_Disease = _1j_Pre_Existing_Disease; }

    public double get_1k_Extra_mortality() { return _1k_Extra_mortality; }
    public void set_1k_Extra_mortality(double _1k_Extra_mortality) { this._1k_Extra_mortality = _1k_Extra_mortality; }

    public int get_1p_Policy_Term() { return _1p_Policy_Term; }
    public void set_1p_Policy_Term(int _1p_Policy_Term) { this._1p_Policy_Term = _1p_Policy_Term; }

    public String get_1r_Mandatory_Premium_Period() { return _1r_Mandatory_Premium_Period; }
    public void set_1r_Mandatory_Premium_Period(String _1r_Mandatory_Premium_Period) { this._1r_Mandatory_Premium_Period = _1r_Mandatory_Premium_Period; }

    public double get_1zb_PAV() { return _1zb_PAV; }
    public void set_1zb_PAV(double _1zb_PAV) { this._1zb_PAV = _1zb_PAV; }

    public double get_1zc_per_mille_rating_death() { return _1zc_per_mille_rating_death; }
    public void set_1zc_per_mille_rating_death(double _1zc_per_mille_rating_death) { this._1zc_per_mille_rating_death = _1zc_per_mille_rating_death; }

    public double get_1zd_per_mille_rating_TPD() { return _1zd_per_mille_rating_TPD; }
    public void set_1zd_per_mille_rating_TPD(double _1zd_per_mille_rating_TPD) { this._1zd_per_mille_rating_TPD = _1zd_per_mille_rating_TPD; }

    public double get_1ze_per_mille_rating_SCI() { return _1ze_per_mille_rating_SCI; }
    public void set_1ze_per_mille_rating_SCI(double _1ze_per_mille_rating_SCI) { this._1ze_per_mille_rating_SCI = _1ze_per_mille_rating_SCI; }

    public String get_2a_Death_Benefit() { return _2a_Death_Benefit; }
    public void set_2a_Death_Benefit(String _2a_Death_Benefit) { this._2a_Death_Benefit = _2a_Death_Benefit; }

    public String get_2b_Total_and_Permanent_Disability_TPD() { return _2b_Total_and_Permanent_Disability_TPD; }
    public void set_2b_Total_and_Permanent_Disability_TPD(String _2b) { this._2b_Total_and_Permanent_Disability_TPD = _2b; }

    public String get_2c_Accidental_Death_and_Dismemberment_ADD() { return _2c_Accidental_Death_and_Dismemberment_ADD; }
    public void set_2c_Accidental_Death_and_Dismemberment_ADD(String _2c) { this._2c_Accidental_Death_and_Dismemberment_ADD = _2c; }

    public String get_2d_Staged_Critical_Illness_SCI() { return _2d_Staged_Critical_Illness_SCI; }
    public void set_2d_Staged_Critical_Illness_SCI(String _2d) { this._2d_Staged_Critical_Illness_SCI = _2d; }

    public String get_2e_Hospital_Cash_Benefit_HCB() { return _2e_Hospital_Cash_Benefit_HCB; }
    public void set_2e_Hospital_Cash_Benefit_HCB(String _2e) { this._2e_Hospital_Cash_Benefit_HCB = _2e; }

    public String get_3a_Partial_Withdrawl() { return _3a_Partial_Withdrawl; }
    public void set_3a_Partial_Withdrawl(String _3a_Partial_Withdrawl) { this._3a_Partial_Withdrawl = _3a_Partial_Withdrawl; }

    public double get_3b_Partial_Withdrawl_Amount() { return _3b_Partial_Withdrawl_Amount; }
    public void set_3b_Partial_Withdrawl_Amount(double _3b) { this._3b_Partial_Withdrawl_Amount = _3b; }

    public String getVersion_id() { return version_id; }
    public void setVersion_id(String version_id) { this.version_id = version_id; }

    public String getCall_purpose() { return call_purpose; }
    public void setCall_purpose(String call_purpose) { this.call_purpose = call_purpose; }

    public String getSource_system() { return source_system; }
    public void setSource_system(String source_system) { this.source_system = source_system; }
}


---

2) CalculationResponse.java

package com.eapp.dto.reponseDTO;

public class CalculationResponse {
    private Object apiResponse;
    private String message;
    private double fallbackPremium;

    public Object getApiResponse() { return apiResponse; }
    public void setApiResponse(Object apiResponse) { this.apiResponse = apiResponse; }

    public String getMessage() { return message; }
    public void setMessage(String message) { this.message = message; }

    public double getFallbackPremium() { return fallbackPremium; }
    public void setFallbackPremium(double fallbackPremium) { this.fallbackPremium = fallbackPremium; }
}


---

3) CoherentService.java

package com.eapp.service;

import com.eapp.dto.requestDTO.CalculationRequest;
import com.eapp.dto.reponseDTO.CalculationResponse;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.http.*;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;

import java.util.HashMap;
import java.util.Map;

@Service
public class CoherentService {
    private static final Logger log = LoggerFactory.getLogger(CoherentService.class);

    private final RestTemplate restTemplate = new RestTemplate();

    // Use your full coherent execute URL here (from your message)
    private final String COHERENT_URL = "https://excel.uat.us.coherent.global/cognizant/api/v3/folders/Sanjana_Test/services/Universal-Life-product-TestPrd/execute";

    public CalculationResponse calculatePremium(CalculationRequest request) {
        CalculationResponse result = new CalculationResponse();

        try {
            Map<String, Object> body = buildCoherentBody(request);

            HttpHeaders headers = new HttpHeaders();
            headers.setContentType(MediaType.APPLICATION_JSON);
            // If you need an Authorization header insert here:
            // headers.set("Authorization", "Bearer " + "YOUR_TOKEN_HERE");

            HttpEntity<Map<String,Object>> entity = new HttpEntity<>(body, headers);

            ResponseEntity<Object> resp = restTemplate.exchange(
                    COHERENT_URL,
                    HttpMethod.POST,
                    entity,
                    Object.class
            );

            result.setApiResponse(resp.getBody());
            result.setMessage("Coherent API returned response, success.");
            return result;

        } catch (Exception ex) {
            log.error("Coherent call failed, using fallback calculation", ex);

            // Simple fallback formula: e.g. 2% of Face Amount (customize as needed)
            double fallback = request.get_1d_Face_Amount() * 0.02;
            result.setFallbackPremium(fallback);
            result.setMessage("Coherent API failed, returned fallback premium.");
            return result;
        }
    }

    @SuppressWarnings("unchecked")
    private Map<String,Object> buildCoherentBody(CalculationRequest r) {
        Map<String,Object> body = new HashMap<>();

        Map<String,Object> request_data = new HashMap<>();
        Map<String,Object> inputs = new HashMap<>();

        // fill inputs exactly as expected by Coherent
        inputs.put("_1a_DOB", r.get_1a_DOB());
        inputs.put("_1b_Product", r.get_1b_Product());
        inputs.put("_1c_Gender", r.get_1c_Gender());
        inputs.put("_1d_Face_Amount", r.get_1d_Face_Amount());
        inputs.put("_1e_Occupation", r.get_1e_Occupation());
        inputs.put("_1h_Policy_Inception_Date", r.get_1h_Policy_Inception_Date());
        inputs.put("_1i_Smoker", r.get_1i_Smoker());
        inputs.put("_1j_Pre_Existing_Disease", r.get_1j_Pre_Existing_Disease());
        inputs.put("_1k_Extra_mortality", r.get_1k_Extra_mortality());
        inputs.put("_1p_Policy_Term", r.get_1p_Policy_Term());
        inputs.put("_1r_Mandatory_Premium_Period", r.get_1r_Mandatory_Premium_Period());
        inputs.put("_1zb_PAV", r.get_1zb_PAV());
        inputs.put("_1zc_per_mille_rating_death", r.get_1zc_per_mille_rating_death());
        inputs.put("_1zd_per_mille_rating_TPD", r.get_1zd_per_mille_rating_TPD());
        inputs.put("_1ze_per_mille_rating_SCI", r.get_1ze_per_mille_rating_SCI());

        inputs.put("_2a_Death_Benefit", r.get_2a_Death_Benefit());
        inputs.put("_2b_Total_and_Permanent_Disability_TPD", r.get_2b_Total_and_Permanent_Disability_TPD());
        inputs.put("_2c_Accidental_Death_and_Dismemberment_ADD", r.get_2c_Accidental_Death_and_Dismemberment_ADD());
        inputs.put("_2d_Staged_Critical_Illness_SCI", r.get_2d_Staged_Critical_Illness_SCI());
        inputs.put("_2e_Hospital_Cash_Benefit_HCB", r.get_2e_Hospital_Cash_Benefit_HCB());

        inputs.put("_3a_Partial_Withdrawl", r.get_3a_Partial_Withdrawl());
        inputs.put("_3b_Partial_Withdrawl_Amount", r.get_3b_Partial_Withdrawl_Amount());

        request_data.put("inputs", inputs);
        body.put("request_data", request_data);

        Map<String,Object> meta = new HashMap<>();
        meta.put("version_id", r.getVersion_id());
        meta.put("call_purpose", r.getCall_purpose());
        meta.put("source_system", r.getSource_system());
        body.put("request_meta", meta);

        return body;
    }
}


---

4) PremiumController.java

package com.eapp.controller;

import com.eapp.dto.requestDTO.CalculationRequest;
import com.eapp.dto.reponseDTO.CalculationResponse;
import com.eapp.service.CoherentService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/premium")
public class PremiumController {

    @Autowired
    private CoherentService coherentService;

    @PostMapping("/calculate")
    public CalculationResponse calculatePremium(@RequestBody CalculationRequest request) {
        return coherentService.calculatePremium(request);
    }
}


---

5) SecurityConfig.java (optional, add if you use Spring Security)

package com.eapp.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.config.annotation.authentication.configuration.AuthenticationConfiguration;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.web.SecurityFilterChain;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;

@Configuration
public class SecurityConfig {

    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }

    @Bean
    public AuthenticationManager authenticationManager(AuthenticationConfiguration conf) throws Exception {
        return conf.getAuthenticationManager();
    }

    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http.csrf(csrf -> csrf.disable())
            .authorizeHttpRequests(auth -> auth
                .requestMatchers(
                    "/swagger-ui/**",
                    "/v3/api-docs/**",
                    "/api/auth/**",
                    "/premium/**"
                ).permitAll()
                .anyRequest().authenticated()
            );

        return http.build();
    }
}


---

Notes & next steps to avoid errors in IntelliJ

1. Replace existing files with these plain Java files (no Lombok). Ensure package names match your project structure.


2. If you previously had Lombok, either remove Lombok usage or keep Lombok dependency + annotation processor enabled. (I removed Lombok to avoid those IDE errors.)


3. Add spring-boot-starter-web in pom.xml (you already have). For RestTemplate no extra dependency required. If you want WebClient you must add reactive dependencies.


4. If you need Authorization header for Coherent, add token to headers.set("Authorization", "Bearer " + token); in CoherentService.


5. Rebuild project / mvn clean package or reload in IntelliJ. The earlier cannot resolve errors should disappear because getters/setters exist explicitly.


6. Test in Postman / Swagger: POST http://localhost:8001/premium/calculate with JSON body like the sample you provided.




---

If you want, I can:

Modify fallback formula (use age, smoker, sumassured) â€” tell me exact rule.

Add an example sample JSON body for testing (I can paste that ready-to-send).

Add header token insertion and how to put token in Swagger UI (I can show Swagger config steps).


Which one next? Want the test JSON body now?
